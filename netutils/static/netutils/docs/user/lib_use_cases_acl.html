
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://netutils.readthedocs.io/en/latest/user/lib_use_cases_acl.html">
      
      
        <link rel="prev" href="lib_use_cases_os_version.html">
      
      
        <link rel="next" href="lib_upgrade_paths.html">
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.32">
    
    
      
        <title>ACL - Netutils Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/extra.css">
    
      <link rel="stylesheet" href="../classy.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#acl" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Netutils Documentation" class="md-header__button md-logo" aria-label="Netutils Documentation" data-md-component="logo">
      
  <img src="../assets/networktocode_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Netutils Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ACL
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/networktocode/netutils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="lib_overview.html" class="md-tabs__link">
          
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../admin/install.html" class="md-tabs__link">
          
  
    
  
  Administrator Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../dev/extending.html" class="md-tabs__link">
          
  
    
  
  Developer Guide

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Netutils Documentation" class="md-nav__button md-logo" aria-label="Netutils Documentation" data-md-component="logo">
      
  <img src="../assets/networktocode_logo.svg" alt="logo">

    </a>
    Netutils Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/networktocode/netutils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lib_overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Library Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lib_use_cases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lib_use_cases_jinja_filters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jinja Filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lib_use_cases_lib_mapper.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Library Mapper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lib_use_cases_protocol_mappers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protocol Mapper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/include_parser_list.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config Parsers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lib_use_cases_nist.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NIST Utility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lib_use_cases_os_version.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OS Software Version Utility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ACL
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="lib_use_cases_acl.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ACL
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cartesian-product" class="md-nav__link">
    <span class="md-ellipsis">
      Cartesian Product
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-method-attrs" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Method - Attrs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-method-any" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Method - Any
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aclrule" class="md-nav__link">
    <span class="md-ellipsis">
      ACLRule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ACLRule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization-loading-data" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization &amp; Loading Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enforce" class="md-nav__link">
    <span class="md-ellipsis">
      Enforce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-match-details" class="md-nav__link">
    <span class="md-ellipsis">
      Match &amp; Match Details
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aclrules" class="md-nav__link">
    <span class="md-ellipsis">
      ACLRules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lib_upgrade_paths.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade Paths
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lib_getting_started.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="faq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frequently Asked Questions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administrator Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Administrator Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/install.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install and Configure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/upgrade.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/uninstall.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Uninstall
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../admin/release_notes/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Release Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.15.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.15
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.14.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.14
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.13.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.13
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.12.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.12
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.11.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.11
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.10.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.10
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.9.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.9
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.8.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.7.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.7
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.6.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.5.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.4.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_1.0.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v1.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_0.2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v0.2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin/release_notes/version_0.1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v0.1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/extending.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending the Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/contributing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing to the Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/dev_environment.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/release_checklist.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Checklist
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/dev_config.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config Parser Development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/dev_adr.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arch Decision Records
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/attribution.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Attribution to the Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../dev/code_reference/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/asn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ASN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/acl.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ACL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/bandwidth.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bandwidth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/banner.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Banner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/configs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/dns.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/hash.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/interface.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/ip.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/lib_helpers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Library Helpers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/lib_mapping.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Library Mapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/mac.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mac Address
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/nist.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NIST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/os_version.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OS Version
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/password.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/ping.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/protocol_mapper.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protocol Mapper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/regex.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/route.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Route
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/time.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/code_reference/vlan.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VLAN
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Classy Docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            Classy Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/classy/parser.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parser
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cartesian-product" class="md-nav__link">
    <span class="md-ellipsis">
      Cartesian Product
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-method-attrs" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Method - Attrs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-method-any" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Method - Any
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aclrule" class="md-nav__link">
    <span class="md-ellipsis">
      ACLRule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ACLRule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization-loading-data" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization &amp; Loading Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enforce" class="md-nav__link">
    <span class="md-ellipsis">
      Enforce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-match-details" class="md-nav__link">
    <span class="md-ellipsis">
      Match &amp; Match Details
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aclrules" class="md-nav__link">
    <span class="md-ellipsis">
      ACLRules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="acl">ACL<a class="headerlink" href="#acl" title="Permanent link">&para;</a></h1>
<p>The ACL classes are intended to help guide the ACL conversation. It is not intended to solve every ACL challenge you may have. In essence, it provides sane defaults and welcomes you to extend the logic via supported extension mechanisms. There are three patterns that heavily make up the capabilities:</p>
<ul>
<li>Expanding data to the <a href="#cartesian-product">"Cartesian product"</a> (or permutations) of each rule, so that each product can be easily evaluated.</li>
<li>Providing a <code>f"{type}_*</code> method pattern, to dynamically find any <code>validate_*</code> or <code>enforce_*</code> method you provide.</li>
<li>Providing a <code>f"{type}_{attr}</code> method pattern, to dynamically find any <code>process_{attr}</code> or <code>match_{attr}</code> method you provide for the given attrs.</li>
</ul>
<p>Each of these are covered in detail, below in the <a href="#core-concepts">core concepts</a> section.</p>
<p>Here you can see how the Python classes work together. There is a lot going on, so I encourage you to review the diagram briefly, and refer back to it often while reviewing the detailed information below.</p>
<p><img alt="ACL Classes" src="../images/acl-workflow.png" /></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>It may be helpful to open the diagram in a new tab to view the full size, as an example, in Chrome you can right-click on the image and select "Open Image on New Tab".</p>
</div>
<p>The intention of this page is not to cover every attribute and it's behavior, but a more human (although highly technical) understanding of what is going on. For more detailed information, please see the <a href="https://github.com/networktocode/netutils/blob/develop/tests/unit/test_acl.py">test</a> and <a href="../dev/code_reference/acl.html">code docs</a>.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In the future the intention is to add features such as better de-duplication, partial match, and path analysis.</p>
</div>
<h2 id="core-concepts">Core Concepts<a class="headerlink" href="#core-concepts" title="Permanent link">&para;</a></h2>
<h3 id="cartesian-product">Cartesian Product<a class="headerlink" href="#cartesian-product" title="Permanent link">&para;</a></h3>
<p>This <a href="https://en.wikipedia.org/wiki/Cartesian_product">"Cartesian product"</a> concept is used throughout the page, so I thought it would be good to review. In this example, we have a single <code>rule</code>, and like many rules, it has multiple sources, destinations, and protocols. The <code>_cartesian_product</code> function creates the permutations, each of which is technically called a product.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">netutils.acl</span><span class="w"> </span><span class="kn">import</span> <span class="n">_cartesian_product</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rule</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">...</span>         <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Allow to internal web&quot;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">...</span>         <span class="n">src_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;192.168.0.0/24&quot;</span><span class="p">,</span> <span class="s2">&quot;10.0.0.0/16&quot;</span><span class="p">],</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">...</span>         <span class="n">dst_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;172.16.0.0/16&quot;</span><span class="p">,</span> <span class="s2">&quot;192.168.250.10-192.168.250.20&quot;</span><span class="p">],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">...</span>         <span class="n">dst_port</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tcp/80&quot;</span><span class="p">,</span> <span class="s2">&quot;udp/53&quot;</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">...</span>         <span class="n">action</span><span class="o">=</span><span class="s2">&quot;permit&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="o">...</span>     <span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">_cartesian_product</span><span class="p">(</span><span class="n">rule</span><span class="p">):</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="o">...</span>   <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="o">...</span> 
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Allow to internal web&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.0.0/24&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;172.16.0.0/16&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Allow to internal web&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.0.0/24&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;172.16.0.0/16&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;udp/53&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Allow to internal web&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.0.0/24&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.250.10-192.168.250.20&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Allow to internal web&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.0.0/24&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.250.10-192.168.250.20&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;udp/53&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Allow to internal web&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.0.0.0/16&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;172.16.0.0/16&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Allow to internal web&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.0.0.0/16&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;172.16.0.0/16&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;udp/53&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Allow to internal web&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.0.0.0/16&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.250.10-192.168.250.20&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Allow to internal web&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.0.0.0/16&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.250.10-192.168.250.20&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;udp/53&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="o">&gt;&gt;&gt;</span> 
</code></pre></div>
<p>Now that you have the Cartesian products, you can evaluate each one individually. In this example perhaps '192.168.0.0/24' -&gt; '172.16.0.0/16' is allowed, but '192.168.0.0/24' -&gt; '192.168.250.10-192.168.250.20' is denied. Yet another example is the access could be allowed on both sources and destinations IPs, but not for udp/53 (DNS).</p>
<p>Having the ability to look at each product individually allows you to only have to worry about the check you wish to create, versus custom logic that attempts to understand the permutations. Building a <code>is_pci_to_non_pci</code> becomes trivial when looking at each product. This idea applies to validating, enforcing, matching, etc.</p>
<h3 id="dynamic-method-attrs">Dynamic Method - Attrs<a class="headerlink" href="#dynamic-method-attrs" title="Permanent link">&para;</a></h3>
<p>The methods <code>process</code> and <code>match</code> both follow this pattern. As an example, the <code>process</code> method will dynamically find any method that follows <code>f"process_{attr}</code> pattern. This allows a Python class that inherits from <code>ACLRule</code> to simply add a <code>process_src_ip</code> method and that method would be called.</p>
<h3 id="dynamic-method-any">Dynamic Method - Any<a class="headerlink" href="#dynamic-method-any" title="Permanent link">&para;</a></h3>
<p>The methods <code>validate</code> and <code>enforce</code> both follow this pattern. As an example, the <code>validate</code> method will dynamically find any method that follows <code>f"process_*</code> pattern. This allows a Python class that inherits from <code>ACLRule</code> to simply add a <code>validate_ip_in_network</code> method and that method would be called.</p>
<p>In both methods, ordering can be controlled with order_validate and order_enforce respectively. The default ordering will be alphabetical, as returned by the Python dir function.</p>
<h2 id="aclrule">ACLRule<a class="headerlink" href="#aclrule" title="Permanent link">&para;</a></h2>
<p>The <code>ACLRule</code> class at a high level:</p>
<ul>
<li>The class <code>ACLRule</code> is used for working with Access Control List (ACL) rules.</li>
<li>It is built with extensibility in mind to allow you to customize how your business operates.</li>
<li>It contains a list of attributes such as "name," "src_ip," "src_zone," "dst_ip," "dst_port," "dst_zone," and "action" that are commonly used to work with ACLs.</li>
<li>Provides the ability for you to expand data such as converting an address-group name into detailed addresses with your custom code.</li>
<li>Provides the Cartesian product (or permutations) of the rules to make evaluation simple.</li>
<li>It provides options for verifying input data and result data (data expanded) with corresponding JSON schemas.</li>
<li>Provides the ability to validate data, generally for tech feasibility testing such as "are IPs on our network and in IPAM" or "is NAT IP provided vs actual IP".</li>
<li>Provides the ability to enforce data, generally for security testing such as "is PCI attempting to talk with a non-PCI environment" or "is IP range not narrowly scoped enough".<ul>
<li>The class supports a matrix feature, which allows users to define custom rule matching based on predefined matrix definitions.</li>
</ul>
</li>
<li>Provides the ability to match one rule to another, to understand if rule exists already.</li>
</ul>
<h3 id="initialization-loading-data">Initialization &amp; Loading Data<a class="headerlink" href="#initialization-loading-data" title="Permanent link">&para;</a></h3>
<p>The initialization process calls on the <code>load_data</code> method. This on a high level verifies schema of initial data, allows you to process data (e.g. convert tcp/https -&gt; 80/443), expand data, determine Cartesian product (or permutations) of the firewall rule (traditionally 5-tuple), and verifies schema of result data.</p>
<p>The Cartesian product (or permutations) is key to the functionality of other steps, this allows you to evaluate each rule based on the smallest view of the data, so pay close attention to those steps, as it is important to other methods as well.</p>
<p>To provide some ideas on what you may validate:</p>
<ul>
<li>Is one of the source or destination IPs in our network?</li>
<li>Is one of the source or destination IPs in our IPAM?</li>
<li>Is the source and destination IPs able to route to each other?</li>
<li>Is the source and destination IPs on the same network?</li>
<li>Is one of the destination IPs to the real IP vs the NAT IP?</li>
<li>Is there routing from the source zone to the destination zone?</li>
<li>Is the business unit name in the description ?</li>
</ul>
<p>Many of validations will be based on IPs, but not all.</p>
<p>Here you will find a written understanding of what is happening in the code:</p>
<ul>
<li>The init method takes in data and calls <code>load_data</code>.</li>
<li>The method <code>load_data</code> processes the input data.<ul>
<li>The <code>input_data_check</code> method is called and verifies the input data based on the specified JSON schema.<ul>
<li>This is controlled by the <code>input_data_verify</code> attribute and schema defined in <code>input_data_schema</code>.</li>
</ul>
</li>
<li>For each <code>self.attrs</code>, a method name matching <code>f"process_{attr}"</code>, (e.g. <code>process_src_ip()</code>) is called.<ul>
<li>This allows you to inherit from and provide your own custom processes to convert, expand, or otherwise modify data before being evaluated.</li>
<li>The <code>process_dst_port</code> method processes the <code>dst_port</code> attribute by converting the protocol and port information, it is enabled by default but controlled with the <code>dst_port_process</code> attribute.</li>
<li>Both a dictionary <code>self.processed</code> and attributes (e.g. self.action, self.src_ip, etc.) are created.</li>
</ul>
</li>
<li>The <code>result_data_check</code> method verifies the processed data based on the specified JSON schema.<ul>
<li>This is controlled by the <code>result_data_verify</code> attribute which is disabled by default.</li>
</ul>
</li>
<li>The <code>validate</code> method validating the rule using a series of custom methods starting with <code>validate_</code> prefixes.<ul>
<li>The ordering can be controlled based on the <code>order_validate</code> attribute or defaults to all matches.</li>
</ul>
</li>
<li>The rules are expanded into <code>self.expanded_rules</code> by creating each permutations of the tuple, using a Cartesian product function.<ul>
<li>An example permutations would be converting source: 10.1.1.1, 10.1.1.2, destination: 10.100.100.100, port: 80 -&gt; 10.1.1.1, destination: 10.100.100.100, port: 80 and 10.1.1.2, destination: 10.100.100.100, port: 80.</li>
<li>This will be key, so that each permutations can be compared individually later.</li>
</ul>
</li>
<li>Filter out the permutations that have the same source and destination IP, if <code>self.filter_same_ip</code> which is on by default.</li>
</ul>
</li>
</ul>
<h3 id="enforce">Enforce<a class="headerlink" href="#enforce" title="Permanent link">&para;</a></h3>
<p>Enforce is generally used for security controls. An <code>enforce_matrix</code> is provided but not used by default. You can think of the matrix as an Excel sheet, in which you have source as the rows and destination as the column. You would identify the source/destination IP and find which x &amp; y coordinates in your Excel document, and perform whatever action it states, such as deny, review, approve, etc.</p>
<p>To provide some ideas on what you may enforce:</p>
<ul>
<li>Is the request for a PCI to non-PCI network?</li>
<li>Is the request for a security-zone-X to security-zone-Y network?</li>
<li>Is the protocol a secure protocol?</li>
<li>Is the request approved?</li>
<li>Is the IPs requested narrowly scoped?</li>
</ul>
<p>Here you will find a written understanding of what is happening in the code:</p>
<ul>
<li>The <code>enforce</code> method validating the rule using a series of custom methods starting with <code>enforce_</code> prefixes such as <code>enforce_pci_checks</code>.<ul>
<li>The ordering can be controlled based on the <code>order_enforce</code> attribute or defaults to all matches.</li>
<li>The <code>enforce_matrix</code> method enforces ACL rules based on a predefined matrix feature.<ul>
<li>This is controlled by the <code>self.matrix_enforced</code> attribute and is off by default.</li>
<li>The <code>enforce_matrix</code> method runs the enforcement checks for each of the <code>self.expanded_rules</code> (or permutations of tuples)</li>
<li>This matrix definition is very simple and not likely ready to be be used in a production environment, instead used for simple demonstrations and communicating potential ideas.</li>
</ul>
</li>
<li>Each method should return a dictionary or list of dictionaries as both of these are handled<ul>
<li>In the example there is the <code>obj</code> and <code>action</code> key.</li>
<li>This could and should be extended, such as providing obj, action, detail_msg, notification_team, and any other metadata that the tooling using this system would require.</li>
<li>Catastrophic errors will raise an error.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>While not accurate in all use cases it would be best practice to run any of your custom <code>enforce_</code> against <code>self.expanded_rules</code>. </p>
<h3 id="match-match-details">Match &amp; Match Details<a class="headerlink" href="#match-match-details" title="Permanent link">&para;</a></h3>
<p>The <code>match_details</code> method provides a verbose way of verifying match details between two ACL rule's, the <code>match</code> method uses <code>match_details</code> and provides a boolean if there are any rules in <code>rules_unmatched</code> which would tell you if you had a full match or not. We will only review in detail the <code>match_details</code>.</p>
<p>Here you will find a written understanding of what is happening in the code:</p>
<ul>
<li>The <code>self.expanded_rules</code> is looped over for every permutations.<ul>
<li>For each <code>self.attrs</code>, a method name matching <code>f"match_{attr}"</code>, (e.g. <code>match_src_ip()</code>) is called.<ul>
<li>This allows you to inherit from and provide your own custom equality check or verify with your business logic.</li>
<li>You do not need to have a <code>f"match_{attr}"</code> method for every attr, description as example would not be a good candidate to match on.</li>
<li>Equality checks are done on <code>src_zone</code>, <code>dst_zone</code>, <code>action</code>, and <code>port</code> by default.</li>
<li>An <code>is_ip_within</code> check is done with for <code>src_ip</code> and <code>dst_ip</code> by default.</li>
</ul>
</li>
</ul>
</li>
<li>In the process, details are provided for and returned:<ul>
<li><code>rules_matched</code> - Root key that is a list of dictionaries of rules that matched.</li>
<li><code>rules_unmatched</code> - Root key that is a list of dictionaries of rules that did not match.</li>
<li><code>existing_rule_product</code> - The original expanded_rule that existed in this item.</li>
<li><code>existing_rule</code> - The full original rule (not expanded_rule) that existed.</li>
<li><code>match_rule</code> - The full original rule that tested against, only shown in <code>rules_matched</code> root key.</li>
</ul>
</li>
</ul>
<p>This data could help you to understand what matched, why it matched, and other metadata. This detail data can be used to in <code>ACLRules</code> to aggregate and ask more interesting questions.</p>
<h2 id="aclrules">ACLRules<a class="headerlink" href="#aclrules" title="Permanent link">&para;</a></h2>
<p>The <code>ACLRules</code> class at a high level:</p>
<ul>
<li>Loads up multiple <code>ACLRule</code> and loads the data from a list of dictionaries.<ul>
<li>This is generally the data that exists on the firewall already, but there are other use cases.</li>
</ul>
</li>
<li>Allows you to match the multiple <code>ACLRule</code> objects, and test against a single <code>ACLRule</code> object.<ul>
<li>This is generally to see if the access to the rule you are testing exists already or not.</li>
</ul>
</li>
</ul>
<p>Using the <code>match_details</code> method, you could as an example, build logic if every product of the rule is matched, just not against a single rule. This is one of many different ways you could use the data. </p>
<h2 id="example-usage">Example Usage<a class="headerlink" href="#example-usage" title="Permanent link">&para;</a></h2>
<p>Here we can test if a rule is matched via the existing ruleset. We can leverage the permit or deny to understand if this exists already or not.</p>
<p><strong>Simple Example</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">netutils.acl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ACLRules</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> 
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">existing_acls</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">...</span>     <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">...</span>         <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Allow to internal web&quot;</span><span class="p">,</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="o">...</span>         <span class="n">src_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;192.168.0.0/24&quot;</span><span class="p">,</span> <span class="s2">&quot;10.0.0.0/16&quot;</span><span class="p">],</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="o">...</span>         <span class="n">dst_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;172.16.0.0/16&quot;</span><span class="p">,</span> <span class="s2">&quot;192.168.250.10-192.168.250.20&quot;</span><span class="p">],</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="o">...</span>         <span class="n">dst_port</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tcp/80&quot;</span><span class="p">,</span> <span class="s2">&quot;udp/53&quot;</span><span class="p">],</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="o">...</span>         <span class="n">action</span><span class="o">=</span><span class="s2">&quot;permit&quot;</span><span class="p">,</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="o">...</span>     <span class="p">),</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="o">...</span>     <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="o">...</span>         <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Allow to internal dns&quot;</span><span class="p">,</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="o">...</span>         <span class="n">src_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="p">],</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="o">...</span>         <span class="n">dst_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;172.16.0.0/16&quot;</span><span class="p">],</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="o">...</span>         <span class="n">dst_port</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tcp/80&quot;</span><span class="p">,</span> <span class="s2">&quot;udp/53&quot;</span><span class="p">],</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="o">...</span>         <span class="n">action</span><span class="o">=</span><span class="s2">&quot;permit&quot;</span><span class="p">,</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="o">...</span>     <span class="p">)</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="o">...</span> <span class="p">]</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="o">&gt;&gt;&gt;</span> 
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">new_acl_match</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="o">...</span>     <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Check multiple sources pass&quot;</span><span class="p">,</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="o">...</span>     <span class="n">src_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;192.168.1.10&quot;</span><span class="p">,</span> <span class="s2">&quot;192.168.1.11&quot;</span><span class="p">,</span> <span class="s2">&quot;192.168.1.15-192.168.1.20&quot;</span><span class="p">],</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="o">...</span>     <span class="n">dst_ip</span><span class="o">=</span><span class="s2">&quot;172.16.0.10&quot;</span><span class="p">,</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="o">...</span>     <span class="n">dst_port</span><span class="o">=</span><span class="s2">&quot;tcp/www-http&quot;</span><span class="p">,</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="o">...</span>     <span class="n">action</span><span class="o">=</span><span class="s2">&quot;permit&quot;</span><span class="p">,</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="o">&gt;&gt;&gt;</span> 
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ACLRules</span><span class="p">(</span><span class="n">existing_acls</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">new_acl_match</span><span class="p">)</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="s1">&#39;permit&#39;</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="o">&gt;&gt;&gt;</span> 
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="o">&gt;&gt;&gt;</span> 
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">new_acl_non_match</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="o">...</span>     <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Check no match&quot;</span><span class="p">,</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="o">...</span>     <span class="n">src_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;10.1.1.1&quot;</span><span class="p">],</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="o">...</span>     <span class="n">dst_ip</span><span class="o">=</span><span class="s2">&quot;172.16.0.10&quot;</span><span class="p">,</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="o">...</span>     <span class="n">dst_port</span><span class="o">=</span><span class="s2">&quot;tcp/www-http&quot;</span><span class="p">,</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="o">...</span>     <span class="n">action</span><span class="o">=</span><span class="s2">&quot;permit&quot;</span><span class="p">,</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="o">&gt;&gt;&gt;</span> 
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ACLRules</span><span class="p">(</span><span class="n">existing_acls</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">new_acl_non_match</span><span class="p">)</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="s1">&#39;deny&#39;</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="o">&gt;&gt;&gt;</span> 
</code></pre></div>
<p><strong>Inherit Example</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">netutils.acl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ACLRule</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">ExpandAddrGroups</span><span class="p">(</span><span class="n">ACLRule</span><span class="p">):</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">address_groups</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;red&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">],</span> <span class="s2">&quot;blue&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cyan&quot;</span><span class="p">],</span> <span class="s2">&quot;yellow&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;orange&quot;</span><span class="p">]}</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">addresses</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;white&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;10.1.1.1&quot;</span><span class="p">,</span> <span class="s2">&quot;10.2.2.2&quot;</span><span class="p">],</span> <span class="s2">&quot;cyan&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;10.3.3.3&quot;</span><span class="p">],</span> <span class="s2">&quot;orange&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;10.4.4.4&quot;</span><span class="p">]}</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flattened_addresses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_addresses</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address_groups</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresses</span><span class="p">)</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">flatten_addresses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address_groups</span><span class="p">,</span> <span class="n">addresses</span><span class="p">):</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>        <span class="n">flattened_addresses</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>        <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">subgroups</span> <span class="ow">in</span> <span class="n">address_groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>            <span class="k">if</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>                <span class="n">flattened_addresses</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">addresses</span><span class="p">[</span><span class="n">group</span><span class="p">])</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>            <span class="k">for</span> <span class="n">subgroup</span> <span class="ow">in</span> <span class="n">subgroups</span><span class="p">:</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>                <span class="k">if</span> <span class="n">subgroup</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>                    <span class="n">flattened_addresses</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">addresses</span><span class="p">[</span><span class="n">subgroup</span><span class="p">])</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>                <span class="k">if</span> <span class="n">subgroup</span> <span class="ow">in</span> <span class="n">address_groups</span><span class="p">:</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>                    <span class="n">subgroup_addresses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_addresses</span><span class="p">({</span><span class="n">subgroup</span><span class="p">:</span> <span class="n">address_groups</span><span class="p">[</span><span class="n">subgroup</span><span class="p">]},</span> <span class="n">addresses</span><span class="p">)</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>                    <span class="k">for</span> <span class="n">sub_group</span><span class="p">,</span> <span class="n">ips</span> <span class="ow">in</span> <span class="n">subgroup_addresses</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>                        <span class="n">flattened_addresses</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">sub_group</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ips</span><span class="p">)</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>                        <span class="k">if</span> <span class="n">group</span> <span class="o">!=</span> <span class="n">sub_group</span><span class="p">:</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>                            <span class="n">flattened_addresses</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ips</span><span class="p">)</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>        <span class="k">return</span> <span class="n">flattened_addresses</span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>            <span class="n">ip</span> <span class="o">=</span> <span class="p">[</span><span class="n">ip</span><span class="p">]</span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>        <span class="k">for</span> <span class="n">ip_name</span> <span class="ow">in</span> <span class="n">ip</span><span class="p">:</span>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ip_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ip_name</span><span class="p">)</span>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresses</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ip_name</span><span class="p">):</span>
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>                <span class="n">output</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addresses</span><span class="p">[</span><span class="n">ip_name</span><span class="p">])</span>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">flattened_addresses</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ip_name</span><span class="p">):</span>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>                <span class="n">output</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flattened_addresses</span><span class="p">[</span><span class="n">ip_name</span><span class="p">])</span>
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">output</span><span class="p">)))</span>
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_src_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src_ip</span><span class="p">):</span>
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_ip</span><span class="p">(</span><span class="n">src_ip</span><span class="p">)</span>
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_dst_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst_ip</span><span class="p">):</span>
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_ip</span><span class="p">(</span><span class="n">dst_ip</span><span class="p">)</span>
</code></pre></div>
<p>Using the above object, we can test with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rule_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">...</span>     <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Check allow&quot;</span><span class="p">,</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="o">...</span>     <span class="n">src_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;10.4.4.4&quot;</span><span class="p">],</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="o">...</span>     <span class="n">dst_ip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;white&quot;</span><span class="p">],</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="o">...</span>     <span class="n">dst_port</span><span class="o">=</span><span class="s2">&quot;6/www-http&quot;</span><span class="p">,</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="o">...</span>     <span class="n">action</span><span class="o">=</span><span class="s2">&quot;permit&quot;</span><span class="p">,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="o">&gt;&gt;&gt;</span> 
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">address_object_expanded</span> <span class="o">=</span> <span class="n">ExpandAddrGroups</span><span class="p">(</span><span class="n">rule_data</span><span class="p">)</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">address_object_expanded</span><span class="o">.</span><span class="n">expanded_rules</span><span class="p">:</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="o">...</span>   <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="o">...</span> 
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Check allow&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.1.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.2.2.2&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;6/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Check allow&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.2.2.2&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.1.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;6/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Check allow&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.3.3.3&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.1.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;6/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Check allow&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.3.3.3&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.2.2.2&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;6/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Check allow&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.4.4.4&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.1.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;6/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Check allow&#39;</span><span class="p">,</span> <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.4.4.4&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;10.2.2.2&#39;</span><span class="p">,</span> <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="s1">&#39;6/80&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;permit&#39;</span><span class="p">}</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="o">&gt;&gt;&gt;</span> 
</code></pre></div>
<p>In that example you can see how we expanded <code>red</code> -&gt; 10.1.1.1", "10.2.2.2", "10.3.3.3" as an example.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
    
    <div class="md-copyright__highlight">
        Copyright &copy; The Authors
    </div>
    <a href="https://github.com/networktocode/netutils/blob/main/LICENSE">Apache-2.0 LICENSE</a>
    
</div>

<div class="md-copyright">
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">Made with Material for MkDocs</a>
    | <a href="https://www.networktocode.com/community/" target="_blank" rel="noopener">Join Network to Code Slack</a>
    
    | <a href="https://networktocode.com" target="_blank" rel="noopener">Sponsored by <img
            src=../assets/networktocode_bw.png class="copyright-logo"></a>
    
</div>

<!-- RTD version flyout injected on live site -->
<div id="readthedocs-embed-flyout"></div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://blog.networktocode.com/" target="_blank" rel="noopener" title="Network to Code Blog" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64zm0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0zm32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.youtube.com/channel/UCwBh-dDdoqzxXKyvTw3BuTw" target="_blank" rel="noopener" title="Network to Code Videos" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.networktocode.com/community/" target="_blank" rel="noopener" title="Network to Code Community" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/networktocode/" target="_blank" rel="noopener" title="GitHub Organization" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://twitter.com/networktocode" target="_blank" rel="noopener" title="Network to Code Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.471ce7a9.min.js"></script>
      
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      
    
  </body>
</html>